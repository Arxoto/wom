function debounce(delay,fn){let timerId=null;return function(...args){clearTimeout(timerId);timerId=setTimeout(()=>{fn(...args);timerId=null},delay)}}let sendLock=false;const doSearch=debounce(100,()=>{if(sendLock){return}chrome.storage.local.set({inkey:womIn.value});if(womIn.value===""){return searchPlugin()}searchPlugin(womIn.value)});womIn.addEventListener("compositionstart",()=>{sendLock=true});womIn.addEventListener("compositionend",()=>{sendLock=false});womIn.addEventListener("input",doSearch);function keyDown(){if(!items||itemId===null){return}if(itemId<items.length-1){selectItem(itemId+1)}else{selectItem(0)}}function keyUp(){if(!items||itemId===null){return}if(itemId>0){selectItem(itemId-1)}else{selectItem(items.length-1)}}function keyRight(){let aitem=document.getElementById("witem"+itemId);let id=aitem.getAttribute("pluginId");let flag=aitem.getAttribute("wflag");let flags=plugins[id].flags;if(!Array.isArray(flags)){return false}let i=flags.indexOf(flag);if(i>=flags.length-1){return false}aitem.setAttribute("wflag",flags[i+1]);return true}function keyLeft(){let aitem=document.getElementById("witem"+itemId);let id=aitem.getAttribute("pluginId");let flag=aitem.getAttribute("wflag");let flags=plugins[id].flags;if(!Array.isArray(flags)){return false}let i=flags.indexOf(flag);if(i<=0){return false}aitem.setAttribute("wflag",flags[i-1]);return true}window.addEventListener("keydown",event=>{if(event.defaultPrevented){return}switch(event.key){case"Escape":window.close();break;case"Enter":executeBySelected();break;case"ArrowUp":event.preventDefault();keyUp();break;case"ArrowDown":event.preventDefault();keyDown();break;case"ArrowLeft":if(keyLeft()){event.preventDefault()}break;case"ArrowRight":if(keyRight()){event.preventDefault()}break;default:break}});bulidBody();onStart();doSearch();document.body.onblur=unshow;