function executeByElement(){let id=this.getAttribute("pluginId");let wflag=this.getAttribute("wflag");plugins[id].run(wflag,womParam);unshow()}function executeBySelected(){let aitem=document.getElementById("witem"+itemId);let id=aitem.getAttribute("pluginId");let wflag=aitem.getAttribute("wflag");plugins[id].run(wflag,womParam);unshow()}function showItem(pluginId,plugin){let aitem=document.createElement("w-item");aitem.id="witem"+items.length;aitem.setAttribute("pluginId",pluginId);aitem.setAttribute("wtype",plugin.wtype);aitem.setAttribute("wname",plugin.wname);aitem.setAttribute("winfo",plugin.winfo);if(Array.isArray(plugin.flags)){aitem.setAttribute("wflag",plugin.flags[0]||"")}else{aitem.setAttribute("wflag",plugin.flags)}aitem.onclick=executeByElement;womBody.appendChild(aitem);items.push(pluginId)}function throttle(delay,fn){let cd=false;return function(...args){if(cd){return}cd=true;fn(...args);setTimeout(()=>{cd=false},delay)}}const selectItem=throttle(50,(elementIndex,settings)=>{if(elementIndex==null){return}itemId!==null&&(document.getElementById("witem"+itemId).firstElementChild.className="");itemId=elementIndex;let aitem=document.getElementById("witem"+itemId);aitem.firstElementChild.className="active";document.getElementById("womTag").innerHTML=1+itemId+"/"+items.length;document.getElementById("fixedBox").style.display="none";if(aitem.offsetTop<=womBody.offsetTop+womBody.scrollTop){aitem.scrollIntoView()}else if(aitem.getBoundingClientRect().bottom>window.innerHeight){aitem.scrollIntoView(false)}});function formatSearch(search){search=search.replace(/ +/," ");let key,param;let indexSpace=search.indexOf(" ");if(indexSpace<0){key=search;param=""}else if(indexSpace>0){key=search.substring(0,indexSpace);param=search.substring(indexSpace+1)}else{key="";param=search.substring(1)}return[key,param,param.length>0]}function searchPlugin(input){bulidBody();if(!input){return selectItem(null,{winH:true})}const[input_key,input_param,has_param]=formatSearch(input);womParam=input_param;for(let i=0;i<customFilters.length;i++){let pluginId=customFilters[i];let plugin=plugins[pluginId];if(plugin.filter(input_key,input_param,has_param,input)){showItem(pluginId,plugin);continue}if(input_key.length===0){showItem(pluginId,plugin)}}for(let i=0;i<plugins.length;i++){if(items.indexOf(i)!==-1){continue}if(plugins[i].wkey!==input_key){continue}if(!has_param){showItem(i,plugins[i]);continue}if(plugins[i].acceptParam&&plugins[i].acceptParam()){showItem(i,plugins[i])}}for(let i=0;i<plugins.length;i++){if(items.indexOf(i)!==-1){continue}if(!plugins[i].wkey.startsWith(input_key)){continue}if(!has_param){showItem(i,plugins[i]);continue}if(plugins[i].acceptParam&&plugins[i].acceptParam()){showItem(i,plugins[i])}}if(items.length===plugins.length){return items&&selectItem(0,{winH:true})}for(let i=0;i<plugins.length;i++){if(items.indexOf(i)!==-1){continue}if(!plugins[i].wkey.includes(input_key)){continue}if(!has_param){showItem(i,plugins[i]);continue}if(plugins[i].acceptParam&&plugins[i].acceptParam()){showItem(i,plugins[i])}}if(items.length===plugins.length){return items&&selectItem(0,{winH:true})}for(let i=0;i<plugins.length;i++){if(items.indexOf(i)!==-1){continue}let key=plugins[i].wkey;if(input_key.length>=key.length){continue}let ki=0,ij=0;while(ki<key.length&&ij<input_key.length){if(key[ki]===input_key[ij]){ij++}ki++}if(ij!==input_key.length){continue}if(!has_param){showItem(i,plugins[i]);continue}if(plugins[i].acceptParam&&plugins[i].acceptParam()){showItem(i,plugins[i])}}if(items.length){selectItem(0,{winH:true})}else{document.getElementById("womTag").innerHTML="N/A";selectItem(null,{winH:true})}}function addPlugin(plugin){plugin.wname=plugin.wname||plugin.wkey;plugin.wkey=plugin.wkey.toLowerCase();plugin.winfo=plugin.winfo||"";plugin.flags=plugin.flags||"";let len=plugins.push(plugin);plugin.filter&&customFilters.push(len-1)}